<!DOCTYPE html>
<html>
	<head>
		<title>КосмоЗвук</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js" crossorigin='anonymous'></script>
        <link rel="stylesheet" href="./style.css">
	</head>
	<body>
		<div class="container">
			<div class="base">
				<img src="./base.png" id="base">
			</div>
			<div class="earth">
				<img src="./earth.png" id='earth'>
			</div>
			<div class="dish">
				<img src="./dish.png" id="dish">
			</div>
		</div>
	</body>
	<script type="text/javascript">

		function rsize(phone, wide) {
			if (phone == true){
				var a = 20;
				var b = 5;
			} else if (wide == true) {
				var a = 10;
				var b = 2;
			} else {
				var a = 16;
				var b = 3;
			}

			$('#earth').css({'width': `${5 * a}%`});
			$('#base').css({'width': `${5 * b}%`});
			$('#dish').css({'width': `${5 * (b + 0.5)}%`});


			$('.earth').css({'height': `${$('#earth').height()}px`});
			$('.base').css({'height': `${$('#base').height()}px`, 'bottom': `${$('.earth').height() * 3.5 / 10}px`});
			$('.dish').css({'height': `${$('#dish').height()}px`, 'bottom': `${$('.earth').height() * 3.5 / 10 + $('.base').height() * 6.5 / 10}px`});
			
		}

		rsize(window.innerHeight > window.innerWidth, window.innerHeight <= window.innerWidth / 2);	

		$(window).on('resize', function(){
		    rsize(window.innerHeight > window.innerWidth, window.innerHeight <= window.innerWidth / 2);
		});

		var mouseXY = {};
	    $( document ).on( "mousemove", function( event ) {
			mouseXY.X = event.pageX; 
			mouseXY.Y = event.pageY;
	    });
	    var fromTop = $(".dish");
	    var fromLeft = $("#dish");
	    var prevXY = {X: null, Y: null};
	    var cowInterval = setInterval(function()
	    {
	    
	      
			if(prevXY.Y != mouseXY.Y || prevXY.X != mouseXY.X) {

				var tp = fromTop.position().top;
				var lft = fromLeft.position().left;
				var diffX = mouseXY.X - lft;
				var diffY = tp - mouseXY.Y;
				var tan = diffX / diffY;

				var degrees = Math.atan(tan)* 180 / Math.PI;
				
				if(diffX > 0 && diffY < 0) {
					degrees += 180;
				}
				else if(diffX < 0 && diffY < 0) {
					degrees -= 180;
				}
				
				if(degrees >= -60 && degrees <= 60){

					prevXY.X = mouseXY.X;
					prevXY.Y = mouseXY.Y;
					fromLeft.css({transform: "rotate(" + degrees + "deg)"});
				}
		    }
	    }, 10);


	</script>
</html>